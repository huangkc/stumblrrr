<%= form_for :location do |f| %>
  Where do you want to go? <%= f.text_field :address %>
  <%= f.submit "stumblrrr" %>
<% end %>

<%= @address %>

<%= form_tag(maps_path, :method => "get", class: "navbar-form", id: "search-form") do %>
    <%= hidden_field_tag :sort_option, :search %>
    <%= text_field_tag :search, params[:search], class: "form-control btn-border", placeholder: "Search Items" %>

      <button class="btn btn-warning btn-border" type="submit">&nbsp;search&nbsp;</button>
<% end %>

<!-- <div align="center">
    <br>

    <form action='/maps' method='post'>
        <input class="search" id="search" type="text" name="address" placeholder="Where do you want to go?" />
        <input type="submit" id="search-button" type="submit"
       style="position: absolute; left: -9999px; width: 1px; height: 1px;"
       tabindex="-1" value="" />
    </form>

  <br>
</div> -->


<div id="map_canvas"></div>





<script>
function buildMap(coords){
  var mapStyle =[
  {
    "featureType": "all",
    "elementType": "labels.text.fill",
    "stylers": [
    {
      "saturation": 36
    },
    {
      "color": "#000000"
    },
    {
      "lightness": 40
    }
    ]
  },
  {
    "featureType": "all",
    "elementType": "labels.text.stroke",
    "stylers": [
    {
      "visibility": "on"
    },
    {
      "color": "#000000"
    },
    {
      "lightness": 16
    }
    ]
  },
  {
    "featureType": "all",
    "elementType": "labels.icon",
    "stylers": [
    {
      "visibility": "off"
    }
    ]
  },
  {
    "featureType": "administrative",
    "elementType": "geometry.fill",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 20
    }
    ]
  },
  {
    "featureType": "administrative",
    "elementType": "geometry.stroke",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 17
    },
    {
      "weight": 1.2
    }
    ]
  },
  {
    "featureType": "landscape",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 20
    }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 21
    }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry.fill",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 17
    }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry.stroke",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 29
    },
    {
      "weight": 0.2
    }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 18
    }
    ]
  },
  {
    "featureType": "road.local",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 16
    }
    ]
  },
  {
    "featureType": "transit",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 19
    }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
    {
      "color": "#000000"
    },
    {
      "lightness": 17
    }
    ]
  }
  ];



  var contentString = '<div id="content">'+
  '<div id="siteNotice">'+
  '</div>'+
  '<h1 id="firstHeading" class="firstHeading">Uluru</h1>'+
  '<div id="bodyContent">'+
  '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
  'sandstone rock formation in the southern part of the '+
  'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) '+
  'south west of the nearest large town, Alice Springs; 450&#160;km '+
  '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major '+
  'features of the Uluru - Kata Tjuta National Park. Uluru is '+
  'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
  'Aboriginal people of the area. It has many springs, waterholes, '+
  'rock caves and ancient paintings. Uluru is listed as a World '+
  'Heritage Site.</p>'+
  '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
  'https://en.wikipedia.org/w/index.php?title=Uluru</a> '+
  '(last visited June 22, 2009).</p>'+
  '</div>'+
  '</div>';

  handler = Gmaps.build('Google');




  handler.buildMap({

    provider: {
      disableDefaultUI: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      styles: mapStyle,


// pass in other Google Maps API options here
},
internal: {
  id: 'map_canvas'

}
},

function(){
  markers = handler.addMarkers([

// Sample todo marker to iterate over
{
  "lat": 51,
  "lng": 12,
  "picture": {
    "url": "http://s29.postimg.org/7acw7mleb/todo.png",
    "width":  52,
    "height": 52
  },

  "infowindow": contentString
},

// Sample arrival marker (only one of these)
{
  "lat": 21,
  "lng": 12,
  "picture": {
    "url": "http://s18.postimg.org/cdenuliv9/arrival.png",
    "width":  32,
    "height": 32
  },
  "infowindow": contentString
},

// Sample arrival marker (only one of these)
{
  "lat": coords.lat,
  "lng": coords.long,
  "picture": {
    "url": "http://s14.postimg.org/moj60jusd/start.png",
    "width":  32,
    "height": 32
  },
  "infowindow": contentString
},

]);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});
}

</script>


<script>
$(document).ready(function(){
  getLocation();
})

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);

  } else {
// x.innerHTML = "Geolocation is not supported by this browser.";
}
}
function showPosition(position) {
  var coords = {
    lat: position.coords.latitude,
    long: position.coords.longitude

  }
  buildMap(coords);
}
</script>
